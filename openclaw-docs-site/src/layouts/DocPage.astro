---
// src/layouts/DocPage.astro
import DocsLayout from './DocsLayout.astro';
import DocsSidebar from '../components/DocsSidebar.astro';
import SearchBar from '../components/SearchBar.astro';

const { title, description } = Astro.props;
const currentPath = Astro.url.pathname;
---

<DocsLayout title={title} description={description}>
  <div class="flex min-h-screen">
    <!-- Desktop sidebar -->
    <div class="hidden md:block">
      <DocsSidebar currentPath={currentPath} />
    </div>

    <!-- Mobile sidebar toggle -->
    <div class="md:hidden fixed top-0 left-0 right-0 bg-white border-b border-gray-200 z-10">
      <div class="flex items-center justify-between p-4">
        <h1 class="text-lg font-semibold">OpenClaw 使用指南</h1>
        <button id="mobile-menu-toggle" class="p-2 rounded-md hover:bg-gray-100">
          <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16" />
          </svg>
        </button>
      </div>
    </div>

    <!-- Mobile sidebar -->
    <div id="mobile-sidebar" class="md:hidden fixed inset-y-0 left-0 w-64 bg-white border-r border-gray-200 transform -translate-x-full transition-transform duration-300 ease-in-out z-20">
      <div class="p-4 border-b border-gray-200">
        <button id="mobile-menu-close" class="p-2 rounded-md hover:bg-gray-100">
          <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" />
          </svg>
        </button>
      </div>
      <DocsSidebar currentPath={currentPath} />
    </div>

    <!-- Mobile overlay -->
    <div id="mobile-overlay" class="md:hidden fixed inset-0 bg-black bg-opacity-50 hidden z-10"></div>

    <!-- Main content -->
    <main class="main-content md:ml-0 ml-0 md:mt-0 mt-16">
      <SearchBar />
      <slot />
    </main>
  </div>

  <script>
    document.addEventListener('DOMContentLoaded', () => {
      const mobileMenuToggle = document.getElementById('mobile-menu-toggle');
      const mobileMenuClose = document.getElementById('mobile-menu-close');
      const mobileSidebar = document.getElementById('mobile-sidebar');
      const mobileOverlay = document.getElementById('mobile-overlay');

      if (mobileMenuToggle) {
        mobileMenuToggle.addEventListener('click', () => {
          mobileSidebar.classList.remove('-translate-x-full');
          mobileOverlay.classList.remove('hidden');
        });
      }

      if (mobileMenuClose) {
        mobileMenuClose.addEventListener('click', () => {
          mobileSidebar.classList.add('-translate-x-full');
          mobileOverlay.classList.add('hidden');
        });
      }

      if (mobileOverlay) {
        mobileOverlay.addEventListener('click', () => {
          mobileSidebar.classList.add('-translate-x-full');
          mobileOverlay.classList.add('hidden');
        });
      }
    });
  </script>
</DocsLayout>